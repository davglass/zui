<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
 <meta charset="utf-8">
 <title>Test ZUI ScrollSnapper</title>
</head>
<style>
li {width:200px;height:300px;border:2px solid #000;background#f00}
</style>
<body class="yui3-skin-sam">
<ul>
 <li>this is page 1</li>
 <li>this is page 2</li>
 <li>this is page 3</li>
 <li>this is page 4</li>
 <li>this is page 5</li>
 <li>this is page 6</li>
 <li>this is page 7</li>
 <li>this is page 8</li>
 <li>this is page 9</li>
 <li>this is page 0</li>
</ul>
</body>
<script src="http://yui.yahooapis.com/3.8.0/build/yui/yui-min.js"></script>
<script type="text/javascript" src="../../build/gallery-zui-scrollsnapper/gallery-zui-scrollsnapper-debug.js"></script> 
<script>
YUI({
    coverage: ['gallery-zui-scrollsnapper'],
    filter: (window.location.search.match(/[?&]filter=([^&]+)/) || [])[1] || 'raw'
}).use('test', 'gallery-zui-scrollsnapper', function (Y) {
    var scroll1 = (new Y.ScrollView({srcNode: 'ul', height: 400, width: 300, render: true})).plug(Y.zui.ScrollSnapper),
        testSuite = new Y.Test.Suite('ZUI scrollhelper'),
        flickTime = 50,
        dragTime = 800,
        testDelay = 500,

        doDrag = function (widget, y, ms) {
            var node = widget.get('contentBox'),
                xy = [10, 10];

            node.simulate('mousedown', {clientX: xy[0], clientY: xy[1]});
            node.simulate('mousemove', {clientX: xy[0], clientY: xy[1] + y});
            Y.later(ms, null, function () {
                node.simulate('mouseup', {clientX: xy[0], clientY: xy[1] + y});
            });
        },

        testScroll = function (test, widget, y, time, diff) {
            widget.scrollTo(0, 0);
            doDrag(widget, down, y, dragDelay);
            test.wait(function () {
                Y.Assert.areSame(-y, widget.get('scrollY'));
                widget.scrollTo(0, 0);
            }, dragDelay + testDelay);
        };

    testSuite.add(new Y.Test.Case({
        name: 'Test drag hehavior',

        testDragNoPlugin: function () {
            testScroll(this, scroll1, -100, testDelay, 1);
        }
    }));

    Y.Test.Runner.add(testSuite);
    Y.Test.Runner.run();
});
</script>
</html>
